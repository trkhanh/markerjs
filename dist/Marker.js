parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"kKdb":[function(require,module,exports) {
var global = arguments[3];
var e=arguments[3];!function(e){"use strict";var t="data-highlighted",n={ELEMENT_NODE:1,TEXT_NODE:3},i=["SCRIPT","STYLE","SELECT","OPTION","BUTTON","OBJECT","APPLET","VIDEO","AUDIO","CANVAS","EMBED","PARAM","METER","PROGRESS"],o="marker-active";function r(e,t){for(var n in e=e||{},t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}function s(e,t){return l(e).color()===l(t).color()}var l=function e(t){return{addClass:function(e){t.classList?t.classList.add(e):t.className+=" "+e},removeClass:function(e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e+"(\\b|$)","gi")," ")},prepend:function(e){for(var n=Array.prototype.slice.call(e),i=n.length;i--;)t.insertBefore(n[i],t.firstChild)},append:function(e){var n=Array.prototype.slice.call(e);i=n.length;for(var i=0,o=n.length;i<o;++i)t.appendChild(n[i])},insertAfter:function(e){return e.parentNode.insertBefore(t,e.nextSibling)},insertBefore:function(e){return e.parentNode.insertBefore(t,e)},remove:function(){t.parentNode.removeChild(t),t=null},contains:function(e){return t!==e&&t.contains(e)},wrap:function(e){return t.parentNode&&t.parentNode.insertBefore(e,t),e.appendChild(t),e},unwrap:function(){var n,i=Array.prototype.slice.call(t.childNodes);return i.forEach(function(t){n=t.parentNode,e(t).insertBefore(t.parentNode),e(n).remove()}),i},parents:function(){for(var e=[];null==t.parentNode;)e.push(void 0),t=void 0;return e},normalizeTextNodes:function(){if(t){if(t.nodeType===n.TEXT_NODE)for(;t.nextSibling&&t.nextSibling.nodeType===n.TEXT_NODE;)t.nodeValue+=t.nextSibling.nodeValue,t.parentNode.removeChild(t.nextSibling);else e(t.firstChild).normalizeTextNodes();e(t.nextSibling).normalizeTextNodes()}},color:function(){return t.style.backgroundColor},fromHTML:function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes},getRange:function(){var n,i=e(t).getSelection();return i.rangeCount>0&&(n=i.getRangeAt(0)),n},removeAllRanges:function(){e(t).getSelection().removeAllRanges()},getSelection:function(){return e(t).getWindow().getSelection()},getWindow:function(){return e(t).getDocument().defaultView},getDocument:function(){return t.ownerDocument||t},hasClass:function(e){return t.classList.contains(e)}}};function a(e,t){e.sort(function(e,n){return l(t?n:e).parents().length-l(t?e:n).parents().length})}function h(e,t){if(!e)throw"Missing anchor element";var n,i;this.el=e,this.options=r(t,{color:"#ffff7b",highlightedClass:"highlighted",contextClass:"marker-context",stateClass:"marker-inactive",onRemoveHighlight:function(){return!0},onBeforeHighlight:function(){return!0},onAfterHighlight:function(){}}),l(this.el).addClass(this.options.contextClass),l(this.el).addClass(this.options.stateClass),n=this.el,i=this,n.addEventListener("mouseup",i.markerHandler.bind(i)),n.addEventListener("touchend",i.markerHandler.bind(i))}h.prototype.destroy=function(){var e,t;e=this.el,t=this,e.removeEventListener("mouseup",t.markerHandler.bind(t)),e.removeEventListener("touchend",t.markerHandler.bind(t)),l(this.el).removeClass(this.options.contextClass)},h.prototype.toggle=function(){l(this.el).hasClass("marker-inactive")?(l(this.el).removeClass("marker-inactive"),l(this.el).addClass(o)):(l(this.el).removeClass(o),l(this.el).removeClass("marker-inactive"))},h.prototype.markerHandler=function(){l(this.el).hasClass(o)&&this.doHighlight()},h.prototype.doHighlight=function(e){var t,n,i,o,r=l(this.el).getRange();r&&!r.collapsed&&(!0===this.options.onBeforeHighlight(r)&&(o=+new Date,(t=h.createWrapper(this.options)).setAttribute("data-timestamp",o),n=this.highlightRange(r,t),i=this.normalizeHighlights(n),this.options.onAfterHighlight(r,i,o)),e||l(this.el).removeAllRanges())},h.prototype.highlightRange=function(e,o){if(!e||e.collapsed)return[];var r,s,a,h=function(e){var t=e.startContainer,i=e.endContainer,o=e.commonAncestorContainer,r=!0;if(0===e.endOffset){for(;!i.previousSibling&&i.parentNode!==o;)i=i.parentNode;i=i.previousSibling}else i.nodeType===n.TEXT_NODE?e.endOffset<i.nodeValue.length&&i.splitText(e.endOffset):e.endOffset>0&&(i=i.childNodes.item(e.endOffset-1));return t.nodeType===n.TEXT_NODE?e.startOffset===t.nodeValue.length?r=!1:e.startOffset>0&&i===(t=t.splitText(e.startOffset)).previousSibling&&(i=t):t=e.startOffset<t.childNodes.length?t.childNodes.item(e.startOffset):t.nextSibling,{startContainer:t,endContainer:i,goDeeper:r}}(e),d=h.startContainer,c=h.endContainer,u=h.goDeeper,p=!1,f=d,g=[];do{u&&f.nodeType===n.TEXT_NODE&&(-1===i.indexOf(f.parentNode.tagName)&&""!==f.nodeValue.trim()&&((s=o.cloneNode(!0)).setAttribute(t,!0),a=f.parentNode,(l(this.el).contains(a)||a===this.el)&&(r=l(f).wrap(s),g.push(r))),u=!1),f!==c||c.hasChildNodes()&&u||(p=!0),f.tagName&&i.indexOf(f.tagName)>-1&&(c.parentNode===f&&(p=!0),u=!1),u&&f.hasChildNodes()?f=f.firstChild:f.nextSibling?(f=f.nextSibling,u=!0):(f=f.parentNode,u=!1)}while(!p);return g},h.prototype.normalizeHighlights=function(e){var t;return this.flattenNestedHighlights(e),this.mergeSiblingHighlights(e),t=e.filter(function(e){return e.parentElement?e:null}),(t=t.filter(function(e,t,n){return n.indexOf(e)===t})).sort(function(e,t){return e.offsetTop-t.offsetTop||e.offsetLeft-t.offsetLeft}),t},h.prototype.flattenNestedHighlights=function(e){var t,n=this;function i(){var t=!1;return e.forEach(function(i,o){var r=i.parentElement;r.previousSibling,r.nextSibling;n.isHighlight(r)&&s(r,i)&&(r.hasChildNodes()?(r.replaceChild(i.firstChild,i),e[o]=r,t=!0):l(r).remove())}),t}a(e,!0);do{t=i()}while(t)},h.prototype.mergeSiblingHighlights=function(e){var t=this;function i(e,i){return i&&i.nodeType===n.ELEMENT_NODE&&s(e,i)&&t.isHighlight(i)}e.forEach(function(e){var t=e.previousSibling,n=e.nextSibling;i(e,t)&&(l(e).prepend(t.childNodes),l(t).remove()),i(e,n)&&(l(e).append(n.childNodes),l(n).remove()),l(e).normalizeTextNodes()})},h.prototype.setColor=function(e){this.options.color=e},h.prototype.getColor=function(){return this.options.color},h.prototype.removeHighlights=function(e){var t=e||this.el,i=this.getHighlights({container:t}),o=this;function r(e){l(e).unwrap().forEach(function(e){var t,i,o;i=(t=e).previousSibling,o=t.nextSibling,i&&i.nodeType===n.TEXT_NODE&&(t.nodeValue=i.nodeValue+t.nodeValue,l(i).remove()),o&&o.nodeType===n.TEXT_NODE&&(t.nodeValue=t.nodeValue+o.nodeValue,l(o).remove())})}a(i,!0),i.forEach(function(e){!0===o.options.onRemoveHighlight(e)&&r(e)})},h.prototype.getHighlights=function(e){var n=(e=r(e,{container:this.el,andSelf:!0,grouped:!1})).container.querySelectorAll("["+t+"]"),i=Array.prototype.slice.call(n);return!0===e.andSelf&&e.container.hasAttribute(t)&&i.push(e.container),e.grouped&&(i=groupHighlights(i)),i},h.prototype.isHighlight=function(e){return e&&e.nodeType===n.ELEMENT_NODE&&e.hasAttribute(t)},h.prototype.serializeHighlights=function(){var e=this.getHighlights(),t=this.el,i=[];return a(e,!1),e.forEach(function(e){var o=0,r=e.textContent.length,s=function(e,t){var n,i=[];do{n=Array.prototype.slice.call(e.parentNode.childNodes),i.unshift(n.indexOf(e)),e=e.parentNode}while(e!==t||!e);return i}(e,t),l=e.cloneNode(!0);l.innerHTML="",l=l.outerHTML,e.previousSibling&&e.previousSibling.nodeType===n.TEXT_NODE&&(o=e.previousSibling.length),i.push([l,e.textContent,s.join(":"),o,r])}),JSON.stringify(i)},h.prototype.serializeHighlights=function(){var e=this.getHighlights(),t=this.el,i=[];return a(e,!1),e.forEach(function(e){var o=0,r=e.textContent.length,s=function(e,t){var n,i=[];do{n=Array.prototype.slice.call(e.parentNode.childNodes),i.unshift(n.indexOf(e)),e=e.parentNode}while(e!==t||!e);return i}(e,t),l=e.cloneNode(!0);l.innerHTML="",l=l.outerHTML,e.previousSibling&&e.previousSibling.nodeType===n.TEXT_NODE&&(o=e.previousSibling.length),i.push([l,e.textContent,s.join(":"),o,r])}),JSON.stringify(i)},h.prototype.deserializeHighlights=function(e){var t,i=[],o=this;if(!e)return i;try{t=JSON.parse(e)}catch(r){throw"Can't parse JSON: "+r}return t.forEach(function(e){try{!function(e){for(var t,r,s,a={wrapper:e[0],text:e[1],path:e[2].split(":"),offset:e[3],length:e[4]},h=a.path.pop(),d=o.el;s=a.path.shift();)d=d.childNodes[s];d.childNodes[h-1]&&d.childNodes[h-1].nodeType===n.TEXT_NODE&&(h-=1),(t=(d=d.childNodes[h]).splitText(a.offset)).splitText(a.length),t.nextSibling&&!t.nextSibling.nodeValue&&l(t.nextSibling).remove(),t.previousSibling&&!t.previousSibling.nodeValue&&l(t.previousSibling).remove(),r=l(t).wrap(l().fromHTML(a.wrapper)[0]),i.push(r)}(e)}catch(r){console&&console.warn&&console.warn("Can't deserialize highlight descriptor. Cause: "+r)}}),i},h.prototype.find=function(e,t){var n=l(this.el).getWindow(),i=n.scrollX,o=n.scrollY,r=void 0===t||t;if(l(this.el).removeAllRanges(),n.find)for(;n.find(e,r);)this.doHighlight(!0);else if(n.document.body.createTextRange){var s=n.document.body.createTextRange();for(s.moveToElementText(this.el);s.findText(e,1,r?4:0)&&(l(this.el).contains(s.parentElement())||s.parentElement()===this.el);)s.select(),this.doHighlight(!0),s.collapse(!1)}l(this.el).removeAllRanges(),n.scrollTo(i,o)},h.createWrapper=function(e){var t=document.createElement("span");return t.style.backgroundColor=e.color,t.className=e.highlightedClass,t},e.TextMarker=h}(window);
},{}]},{},["kKdb"], null)
//# sourceMappingURL=/Marker.js.map